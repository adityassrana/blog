---
keywords: fastai
description: A simple problem statement to display computational speed up due to vectorization and broadcasting in numpy
title: Vectorizing Nearest Neighbours Algorithm
toc: true 
badges: true
comments: true
author: Aditya Rana, Amey Agrawal and Nikhil Verma
image: images/nagarji.jpg
categories: [broadcasting,numpy]
nb_path: _notebooks/2020-25-07-Vectorization.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-25-07-Vectorization.ipynb
-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This problem is similar to Stanford's kNN classifier assignment which implements this algorithm on the CIFAR-10 dataset</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/images/copied_from_nb/my_icons/nagarji.jpg" alt="" title="Redi at BITS Pilani"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Situation">Situation<a class="anchor-link" href="#Situation"> </a></h3><p>In a hypothetical $n$-dimensional universe, there exists $p$ population of a particular species of humans, Homo BITSians. This species likes to hangout in specialized eateries, called Redis. In this universe, there are $q$ Redis which serve delicious snacks and beverages at nominal prices. Our task is to find the nearest Redi from each of the Homo BITSians so that they spend less time on commuting.</p>
<h3 id="Problem">Problem<a class="anchor-link" href="#Problem"> </a></h3><p>Matrices, $X \in p \times n$ and $Y \in q \times n$, which have the co-ordinates of $p$ Homo BITSians and $q$ Redis respectively in the $n$-dimensional universe are given. The $i^{th}$ row in the matrix, $X$, corresponds to the $i^{th}$ Homo BITSian. Similarly, the $i^{th}$ row in the matrix, $Y$, corresponds to the $i^{th}$ Redi.</p>
<p><strong>Note</strong>: Here, row numbering (indexing) starts from $0$.</p>
<h3 id="Task">Task<a class="anchor-link" href="#Task"> </a></h3><p>Given $X$, $Y$, find a vector, $V$, of length $p$. The vector, $V$, is such that the $i^{th}$ element of $V$ has the index of the nearest Redi from the $i^{th}$ Homo BITSian.</p>
<p>Distance metric is the usual $l_2$-norm.
In a n-dimensional space with points $x = (x_0, x_0, \ldots, x_{n-1})$ and $y = (y_0, y_0, \ldots, y_{n-1})$, the distance can be calculated as:</p>
$$D_{xy}^2 = (x_0 - y_0)^2 
+ (x_1 - y_1)^2 + \ldots + (x_{n-1} - y_{n-1})^2$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Part-1:-Find-the-index-of-the-nearest-Redi-from-each-Homo-BITSian">Part 1: Find the index of the nearest Redi from each Homo BITSian<a class="anchor-link" href="#Part-1:-Find-the-index-of-the-nearest-Redi-from-each-Homo-BITSian"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Base Distance Function to be completed by the student</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">distances</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given matrices X and Y, the function returns a distance matrix. </span>
<span class="sd">    The (i,j)th element of the matrix contains the distance of jth Redi </span>
<span class="sd">    from the ith Homo BITSian.</span>
<span class="sd">    </span>
<span class="sd">    Parameters: X,Y</span>
<span class="sd">    Returns: D</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">### BEGIN SOLUTION</span>

    <span class="c1">### END SOLUTION</span>
    
    <span class="k">return</span> <span class="n">D</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">nearest_redi</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given matrices X and Y, the function returns a nearest redi vector. </span>
<span class="sd">    The i-th element of the vector contains the index of nearest Redi </span>
<span class="sd">    from the ith Homo BITSian.</span>
<span class="sd">    </span>
<span class="sd">    Parameters: X,Y</span>
<span class="sd">    Returns: V</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">D</span> <span class="o">=</span> <span class="n">distances</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
    
    <span class="c1">### BEGIN SOLUTION</span>

    <span class="c1">### END SOLUTION</span>
    
    <span class="k">return</span> <span class="n">V</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Solutions-begin-from-here">Solutions begin from here<a class="anchor-link" href="#Solutions-begin-from-here"> </a></h3><p>The way to understand the <strong>axis</strong> argument in numpy functions is that it collapses the specified axis. So when we specify the axis 1 (the column), it applies the function across all columns, resulting in a single column.For more intuition check out this <a href="https://medium.com/@aerinykim/numpy-sum-axis-intuition-6eb94926a5d1">post</a> by Aerin Kim. In fact, I would reccommend you to read all of her posts.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">nearest_redi</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">distances</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">V</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's evaluate the time taken by different approaches</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1024</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="single-loop-using--matrix-addition/subtraction-broadcast">single loop using  matrix addition/subtraction broadcast<a class="anchor-link" href="#single-loop-using--matrix-addition/subtraction-broadcast"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">distances</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dist</span>
<span class="o">%</span><span class="k">time</span> test1  = nearest_redi(X, Y)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 276 ms, sys: 0 ns, total: 276 ms
Wall time: 274 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="no-loops,-using-a-gigantic-outer-product-by-forming-a-3-d-matrix-of-distances.-Neat-but-still-inefficient.-Explained-here">no loops, using a gigantic outer product by forming a 3-d matrix of distances. Neat but still inefficient. Explained <a href="http://scipy.github.io/old-wiki/pages/EricsBroadcastingDoc">here</a><a class="anchor-link" href="#no-loops,-using-a-gigantic-outer-product-by-forming-a-3-d-matrix-of-distances.-Neat-but-still-inefficient.-Explained-here"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">distances</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dist</span>
<span class="o">%</span><span class="k">time</span> test2  = nearest_redi(X, Y)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 342 ms, sys: 104 ms, total: 446 ms
Wall time: 443 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="no-loop,-but-breaking-up-the-L2-norm-into-individual-terms">no loop, but breaking up the L2 norm into individual terms<a class="anchor-link" href="#no-loop,-but-breaking-up-the-L2-norm-into-individual-terms"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% raw %}
$$ \left\| \mathbf{I_1} - \mathbf{I_2} \right\| = \sqrt{ \left\| \mathbf{I_1} \right\|^2 + \left\| \mathbf{I_2} \right\| ^2 - 2 \mathbf{I_1}\cdot\mathbf{I_2}} $$
{% endraw %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">distances</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dist</span>
<span class="o">%</span><span class="k">time</span> test3  = nearest_redi(X, Y)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 40.5 ms, sys: 0 ns, total: 40.5 ms
Wall time: 7.01 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test-Your-Algorithm">Test Your Algorithm<a class="anchor-link" href="#Test-Your-Algorithm"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running base test case 1...&quot;</span><span class="p">)</span>

<span class="n">X_test1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">],</span>
                    <span class="p">[</span> <span class="mf">4.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>

<span class="n">Y_test1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">3.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">3.</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.</span><span class="p">]])</span>

<span class="n">V_test1</span> <span class="o">=</span> <span class="n">nearest_redi</span><span class="p">(</span><span class="n">X_test1</span><span class="p">,</span> <span class="n">Y_test1</span><span class="p">)</span>
<span class="n">V_ans_test1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">V_test1</span><span class="p">,</span> <span class="n">V_ans_test1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Base test case 1 successful!!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>



<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running base test case 2...&quot;</span><span class="p">)</span>

<span class="n">X_test2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.08170274</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.8955951</span> <span class="p">,</span> <span class="o">-</span><span class="mf">4.0473417</span> <span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">1.13259313</span><span class="p">,</span>  <span class="mf">4.38171415</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.22068891</span><span class="p">]])</span>

<span class="n">Y_test2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">3.79010736</span><span class="p">,</span>  <span class="mf">1.70042849</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.06603884</span><span class="p">],</span>
                    <span class="p">[</span> <span class="mf">3.8921235</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.85207272</span><span class="p">,</span>  <span class="mf">2.33340715</span><span class="p">],</span>
                    <span class="p">[</span> <span class="mf">1.67360485</span><span class="p">,</span>  <span class="mf">2.11437547</span><span class="p">,</span>  <span class="mf">0.87529999</span><span class="p">]])</span>

<span class="n">V_test2</span> <span class="o">=</span> <span class="n">nearest_redi</span><span class="p">(</span><span class="n">X_test2</span><span class="p">,</span> <span class="n">Y_test2</span><span class="p">)</span>
<span class="n">V_ans_test2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">V_test2</span><span class="p">,</span> <span class="n">V_ans_test2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Base test case 2 successful!!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Running base test case 1...
Base test case 1 successful!!

Running base test case 2...
Base test case 2 successful!!

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="c1"># Running hidden test case for Part 1. Don&#39;t edit the cell.                                     *** 5 marks ***</span>
<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.27170746</span><span class="p">,</span>  <span class="mf">0.89441607</span><span class="p">,</span>  <span class="mf">0.64849028</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.42296173</span><span class="p">,</span>  <span class="mf">0.54342876</span><span class="p">,</span>  <span class="mf">0.47889235</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.48688657</span><span class="p">,</span>  <span class="mf">0.11082849</span><span class="p">,</span>  <span class="mf">0.10691689</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.04419385</span><span class="p">,</span>  <span class="mf">0.68777309</span><span class="p">,</span>  <span class="mf">0.49437059</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.70143641</span><span class="p">,</span>  <span class="mf">0.09964604</span><span class="p">,</span>  <span class="mf">0.20949214</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.01725016</span><span class="p">,</span>  <span class="mf">0.37424641</span><span class="p">,</span>  <span class="mf">0.94070338</span><span class="p">]])</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.24232741</span><span class="p">,</span>  <span class="mf">0.08413896</span><span class="p">,</span>  <span class="mf">0.014919</span>  <span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.15801316</span><span class="p">,</span>  <span class="mf">0.31713579</span><span class="p">,</span>  <span class="mf">0.0416702</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.15784176</span><span class="p">,</span>  <span class="mf">0.50998073</span><span class="p">,</span>  <span class="mf">0.45405793</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.44382259</span><span class="p">,</span>  <span class="mf">0.44515729</span><span class="p">,</span>  <span class="mf">0.49186482</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.00695024</span><span class="p">,</span>  <span class="mf">0.23603969</span><span class="p">,</span>  <span class="mf">0.77601819</span><span class="p">]])</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">nearest_redi</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">V_ans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">V_ans</span><span class="p">)</span>
<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Extra-Resources">Extra Resources<a class="anchor-link" href="#Extra-Resources"> </a></h3><ol>
<li><a href="https://www.labri.fr/perso/nrougier/from-python-to-numpy/">https://www.labri.fr/perso/nrougier/from-python-to-numpy/</a> - Read the sections on Code Vectorization and Problem Vectorization</li>
<li><a href="https://medium.com/@mikeliao/numpy-vectorization-d4adea4fc2a">https://medium.com/@mikeliao/numpy-vectorization-d4adea4fc2a</a></li>
<li><a href="https://mlxai.github.io/2017/01/03/finding-distances-between-data-points-with-numpy.html">https://mlxai.github.io/2017/01/03/finding-distances-between-data-points-with-numpy.html</a></li>
</ol>

</div>
</div>
</div>
</div>
 

